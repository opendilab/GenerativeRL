# ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ 
    
[![Twitter](https://img.shields.io/twitter/url?style=social&url=https%3A%2F%2Ftwitter.com%2Fopendilab)](https://twitter.com/opendilab)    
[![GitHub stars](https://img.shields.io/github/stars/opendilab/GenerativeRL)](https://github.com/opendilab/GenerativeRL/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/opendilab/GenerativeRL)](https://github.com/opendilab/GenerativeRL/network)
![GitHub commit activity](https://img.shields.io/github/commit-activity/m/opendilab/GenerativeRL)
[![GitHub issues](https://img.shields.io/github/issues/opendilab/GenerativeRL)](https://github.com/opendilab/GenerativeRL/issues)
[![GitHub pulls](https://img.shields.io/github/issues-pr/opendilab/GenerativeRL)](https://github.com/opendilab/GenerativeRL/pulls)
[![Contributors](https://img.shields.io/github/contributors/opendilab/GenerativeRL)](https://github.com/opendilab/GenerativeRL/graphs/contributors)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)

[è‹±è¯­ (English)](https://github.com/opendilab/GenerativeRL/blob/main/README.md) | ç®€ä½“ä¸­æ–‡

**GenerativeRL** æ˜¯ä¸€ä¸ªä½¿ç”¨ç”Ÿæˆå¼æ¨¡å‹è§£å†³å¼ºåŒ–å­¦ä¹ é—®é¢˜çš„ç®—æ³•åº“ï¼Œæ”¯æŒæ‰©æ•£æ¨¡å‹å’Œæµæ¨¡å‹ç­‰ä¸åŒç±»å‹çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚è¿™ä¸ªåº“æ—¨åœ¨æä¾›ä¸€ä¸ªæ¡†æ¶ï¼Œå°†ç”Ÿæˆå¼æ¨¡å‹çš„èƒ½åŠ›ä¸å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å†³ç­–èƒ½åŠ›ç›¸ç»“åˆã€‚

## å¤§çº²

- [ç‰¹æ€§](#ç‰¹æ€§)
- [æ¡†æ¶ç»“æ„](#æ¡†æ¶ç»“æ„)
- [å·²é›†æˆçš„ç”Ÿæˆå¼æ¨¡å‹](#å·²é›†æˆçš„ç”Ÿæˆå¼æ¨¡å‹)
- [å·²é›†æˆçš„ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ ç®—æ³•](#å·²é›†æˆçš„ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ ç®—æ³•)
- [å®‰è£…](#å®‰è£…)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ•™ç¨‹](#æ•™ç¨‹)
- [åŸºçº¿å®éªŒ](#åŸºçº¿å®éªŒ)

## ç‰¹æ€§

- æ”¯æŒå¤šç§æ‰©æ•£æ¨¡å‹å’Œæµæ¨¡å‹ç­‰ä¸åŒç±»å‹çš„ç”Ÿæˆå¼æ¨¡å‹çš„è®­ç»ƒã€è¯„ä¼°å’Œéƒ¨ç½²
- åœ¨å¼ºåŒ–å­¦ä¹ ç®—æ³•ä¸­é›†æˆç”Ÿæˆå¼æ¨¡å‹ï¼Œç”¨äºçŠ¶æ€ä¸åŠ¨ä½œè¡¨ç¤ºï¼Œç­–ç•¥å­¦ä¹ ä¸ç¯å¢ƒæ¨¡å‹çš„å­¦ä¹ 
- å®ç°äº†å¤šç§åŸºäºç”Ÿæˆå¼æ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•
- æ”¯æŒå¤šç§å¼ºåŒ–å­¦ä¹ ç¯å¢ƒå’ŒåŸºå‡†
- æ˜“äºä½¿ç”¨çš„è®­ç»ƒå’Œè¯„ä¼° API

## æ¡†æ¶ç»“æ„

<p align="center">
  <img src="assets/framework.png" alt="Image Description 1" width="80%" height="auto" style="margin: 0 1%;">
</p>

## å·²é›†æˆçš„ç”Ÿæˆå¼æ¨¡å‹

|                                                                                     | [Score Matching](https://ieeexplore.ieee.org/document/6795935) | [Flow Matching](https://arxiv.org/abs/2210.02747) |
|-------------------------------------------------------------------------------------| -------------------------------------------------------------- | ------------------------------------------------- |
| **æ‰©æ•£æ¨¡å‹**   [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/18yHUAmcMh_7xq2U6TBCtcLKX2y4YvNyk)    |               |               |
| [Linear VP SDE](https://arxiv.org/abs/2011.13456)                                   | âœ”                                                              | âœ”                                                |
| [Generalized VP SDE](https://arxiv.org/abs/2209.15571)                              | âœ”                                                              | âœ”                                                |
| [Linear SDE](https://arxiv.org/abs/2206.00364)                                      | âœ”                                                              | âœ”                                                |
| **æµæ¨¡å‹**    [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1vrxREVXKsSbnsv9G2CnKPVvrbFZleElI)    |               |                |
| [Independent Conditional Flow Matching](https://arxiv.org/abs/2302.00482)           | ğŸš«                                                             | âœ”                                                 |
| [Optimal Transport Conditional Flow Matching](https://arxiv.org/abs/2302.00482)     | ğŸš«                                                             | âœ”                                                 |

## å·²é›†æˆçš„ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ ç®—æ³•

| ç®—æ³•/æ¨¡å‹                                           | æ‰©æ•£æ¨¡å‹                                                                                                                                                               | æµæ¨¡å‹                  |
|---------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------- |
| [QGPO](https://arxiv.org/abs/2304.12824)            | âœ”                                                                                                                                                                    |  ğŸš«                   |
| [SRPO](https://arxiv.org/abs/2310.07297)            | âœ”                                                                                                                                                                    |  ğŸš«                   |
| GMPO                                                | âœ”  [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1A79ueOdLvTfrytjOPyfxb6zSKXi1aePv)           | âœ”                     |
| GMPG                                                | âœ”  [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1hhMvQsrV-mruvpSCpmnsOxmCb6bMPOBq)           | âœ”                     |

## å®‰è£…

```bash
pip install grl
```

æˆ–è€…ï¼Œå¦‚æœä½ æƒ³ä»æºç å®‰è£…ï¼š

```bash
git clone https://github.com/opendilab/GenerativeRL.git
cd GenerativeRL
pip install -e .
```

æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ Docker é•œåƒï¼š
```bash
docker pull opendilab/grl:torch2.3.0-cuda12.1-cudnn8-runtime
docker run -it --rm --gpus all opendilab/grl:torch2.3.0-cuda12.1-cudnn8-runtime /bin/bash
```

## å¯åŠ¨

è¿™æ˜¯ä¸€ä¸ªåœ¨ [LunarLanderContinuous-v2](https://www.gymlibrary.dev/environments/box2d/lunar_lander/) ç¯å¢ƒä¸­è®­ç»ƒ Q-guided policy optimization (QGPO) çš„æ‰©æ•£æ¨¡å‹çš„ç¤ºä¾‹ã€‚

å®‰è£…æ‰€éœ€ä¾èµ–ï¼š
```bash
pip install 'gym[box2d]==0.23.1'
```
(æ­¤å¤„çš„ gym ç‰ˆæœ¬å¯ä»¥ä¸º'0.23~0.25', ä½†ä¸ºäº†åŒæ—¶å…¼å®¹ D4RL æ¨èä½¿ç”¨ '0.23.1'ã€‚)

æ•°æ®é›†å¯ä»¥ä» [è¿™é‡Œ](https://drive.google.com/file/d/1YnT-Oeu9LPKuS_ZqNc5kol_pMlJ1DwyG/view?usp=drive_link) ä¸‹è½½ï¼Œè¯·å°†å…¶ç½®äºå·¥ä½œè·¯å¾„ä¸‹ï¼Œå¹¶å‘½åä¸º `data.npz`ã€‚

GenerativeRL ä½¿ç”¨ WandB è®°å½•è®­ç»ƒæ—¥å¿—ã€‚åœ¨ä½¿ç”¨æ—¶ä¼šè¦æ±‚ä½ è”ç½‘ç™»å½•è´¦å·ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦ç”¨å®ƒï¼š
```bash
wandb offline
```

```python
import gym

from grl.algorithms.qgpo import QGPOAlgorithm
from grl.datasets import QGPOCustomizedDataset
from grl.utils.log import log
from grl_pipelines.diffusion_model.configurations.lunarlander_continuous_qgpo import config

def qgpo_pipeline(config):
    qgpo = QGPOAlgorithm(config, dataset=QGPOCustomizedDataset(numpy_data_path="./data.npz",))
    qgpo.train()

    agent = qgpo.deploy()
    env = gym.make(config.deploy.env.env_id)
    observation = env.reset()
    for _ in range(config.deploy.num_deploy_steps):
        env.render()
        observation, reward, done, _ = env.step(agent.act(observation))

if __name__ == '__main__':
    log.info("config: \n{}".format(config))
    qgpo_pipeline(config)
```

æ›´å¤šè¯¦ç»†ç¤ºä¾‹å’Œæ–‡æ¡£ï¼Œè¯·å‚è€ƒ GenerativeRL æ–‡æ¡£ã€‚

## æ•™ç¨‹

æˆ‘ä»¬æä¾›äº†ä¸€äº›æ¡ˆä¾‹æ•™ç¨‹ï¼Œç”¨äºå¸®åŠ©ä½ æ›´å¥½åœ°äº†è§£ GenerativeRLã€‚è¯¦è§äº [tutorials](https://github.com/opendilab/GenerativeRL/tree/main/grl_pipelines/tutorials)ã€‚

## åŸºçº¿å®éªŒ

æˆ‘ä»¬æä¾›äº†ä¸€äº›åŸºçº¿å®éªŒï¼Œç”¨äºè¯„ä¼°ç”Ÿæˆå¼å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„æ€§èƒ½ã€‚è¯¦è§äº [benchmark](https://github.com/opendilab/GenerativeRL/tree/main/grl_pipelines/benchmark)ã€‚

## å¼€æºæ”¯æŒ

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å¯¹ GenerativeRL çš„è´¡çŒ®å’Œæ”¯æŒï¼è¯·å‚è€ƒ [å¼€æºè´¡çŒ®æŒ‡å—](CONTRIBUTING.md)ã€‚

## å¼€æºåè®®

GenerativeRL å¼€æºåè®®ä¸º Apache License 2.0ã€‚æ›´å¤šä¿¡æ¯å’Œæ–‡æ¡£ï¼Œè¯·å‚è€ƒ [å¼€æºåè®®](LICENSE)ã€‚
